package auth_test

import (
	"context"
	"encoding/json"
	"fmt"
	auth "github/hovanhoa/go-vc-auth"
	"github/hovanhoa/go-vc-auth/provider"

	"testing"
)

// TestNewAuth ensures NewAuth returns a non-nil Auth implementation.
func TestNewAuth(t *testing.T) {
	provider := provider.NewVaultProvider("https://vault-dev.pila.vn", "", 3)
	a := auth.NewAuth(provider, "https://auth-dev.pila.vn/api/v1/did")
	if a == nil {
		t.Fatalf("expected non-nil Auth")
	}
}

// Test CreateToken ensures CreateToken returns a non-nil token.
func TestCreateToken(t *testing.T) {
	provider := provider.NewVaultProvider("https://vault-dev.pila.vn", "", 3)
	a := auth.NewAuth(provider, "https://auth-dev.pila.vn/api/v1/did")

	vcJwts := []string{
		"eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgxNmM1MTMwZGVmNjQ5NmY1ZGU5M2Y5MDc2YTVjZWIwNWNlNTllNGIwI2tleS0xIiwidHlwIjoiSldUIn0.eyJleHAiOjAsImlhdCI6MTc2MzQ2NDM1OSwiaXNzIjoiZGlkOm5kYTp0ZXN0bmV0OjB4MTZjNTEzMGRlZjY0OTZmNWRlOTNmOTA3NmE1Y2ViMDVjZTU5ZTRiMCIsImp0aSI6ImRpZDpuZGE6dGVzdG5ldDphOGFmMDNiNi1hNTIwLTRjNjgtODliOC05ZWVlMTBmYzMxNjIiLCJuYmYiOjE3NjM0NjQzNTksInN1YiI6ImRpZDpuZGE6dGVzdG5ldDoweDJhZjdlOGViZmVjMTRmNWUzOTQ2OWQyY2U4NDQyYTVlZWY5ZjNmYTQiLCJ2YyI6eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiY3JlZGVudGlhbFNjaGVtYSI6eyJpZCI6Imh0dHBzOi8vYXV0aC1kZXYucGlsYS52bi9hcGkvdjEvc2NoZW1hcy9kYzdhZDA1ZC02MGQ5LTQyN2QtYTEyNS1hOGUwOWNlOWJiMWUiLCJ0eXBlIjoiSnNvblNjaGVtYSJ9LCJjcmVkZW50aWFsU3ViamVjdCI6eyJjYXBzdWxlIjoiMjAwMDAwMDAxNDY2MmYwNTIxYzU3MGMyMGQ5NWQ4ZDc0YjBlMmY3YTkwNjMxNzc1MzAyYTE2OTJjNTk5YWE2NjI0ZTA5NTExMjAwMDAwMDBiZTczYTRmYzA3NzZkYWI4NTRhNTkyYTRjYmFlOTVkOGM1YTVmNjAyYjcxZjU1ODBlNDVmNzQ4MmRlOWE0ODc5MjAwMDAwMDBjMjRhZjgzMmE0Njk2NzhkMzFhODJmMGMwYzM5ZGE0NGNiMjRjOWMyODVlYzcxM2M0ODIwYzE0ZDc0NDQ0NDQ4MjAwMDAwMDAzYTQ0NGRiOGQ2M2Y4ZmIzNzBjMDdlODk5NmVlYjdmMzRkMjU3ZmZkOGEwNDY3Mjc4MTQzZjk0NjMxYjcwOGRmMjAwMDAwMDBmMjVlOGJiZjdmZmZlYjJjNmMwNWVhOThmNzBjODE0NTA4MWE2ODM5NmE2MWU3M2QzMjc0YTEzZGFjZDQ5ZTc2MDAwMDEwMDAwMDA0MjljZGNkNDExNjlkNTBhZWM5YjE5M2RjNDE3NjI0MjE4ZjJkZWQ1N2M0ZThkMWFhMDMzZGFjMmM5MmNkMjczMjI5OThjMmRkOWVhMjY0MDU0MTVlMjk1YjdjMTk2MDAyNzI2NGM0N2JmNzk3M2U0OTM4OTlmYTY1MDkzYWNlZmYiLCJjaWQiOiJiYWZrcmVpYXU0bnVjczRhcHQ3cHlqNGx4cnNuZWxjc3VvczZ0Mzd6d2M3eWpwYnQ1aG9jZ3lzZ3JieSIsImlkIjoiZGlkOm5kYTp0ZXN0bmV0OjB4MmFmN2U4ZWJmZWMxNGY1ZTM5NDY5ZDJjZTg0NDJhNWVlZjlmM2ZhNCIsInBlcm1pc3Npb25zIjpbInJlYWQiXSwicm9sZSI6InZpZXdlciJ9LCJpZCI6ImRpZDpuZGE6dGVzdG5ldDphOGFmMDNiNi1hNTIwLTRjNjgtODliOC05ZWVlMTBmYzMxNjIiLCJpc3N1ZXIiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgxNmM1MTMwZGVmNjQ5NmY1ZGU5M2Y5MDc2YTVjZWIwNWNlNTllNGIwIiwidHlwZSI6IlZlcmlmaWFibGVDcmVkZW50aWFsIiwidmFsaWRGcm9tIjoiMjAyNS0xMS0xOFQxMToxMjozOVoiLCJ2YWxpZFVudGlsIjoiMTk3MC0wMS0wMVQwMDowMDowMFoifX0.xV4vCvijqYsAVGjf3DiX7qjGsAPa0s2Yd9rgBB67_GNDfxAmFMUVLU0_X1tehZfCzd3Y4EXzifI850c4RD24KQ",
		"eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgxNmM1MTMwZGVmNjQ5NmY1ZGU5M2Y5MDc2YTVjZWIwNWNlNTllNGIwI2tleS0xIiwidHlwIjoiSldUIn0.eyJleHAiOjAsImlhdCI6MTc2MzQ2NjE0OCwiaXNzIjoiZGlkOm5kYTp0ZXN0bmV0OjB4MTZjNTEzMGRlZjY0OTZmNWRlOTNmOTA3NmE1Y2ViMDVjZTU5ZTRiMCIsImp0aSI6ImRpZDpuZGE6dGVzdG5ldDplMTM2ODdmYS02ZDQ4LTQyYTQtOGRmOC00NWI5NjEwYWNiZjgiLCJuYmYiOjE3NjM0NjYxNDgsInN1YiI6ImRpZDpuZGE6dGVzdG5ldDoweDJhZjdlOGViZmVjMTRmNWUzOTQ2OWQyY2U4NDQyYTVlZWY5ZjNmYTQiLCJ2YyI6eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiY3JlZGVudGlhbFNjaGVtYSI6eyJpZCI6Imh0dHBzOi8vYXV0aC1kZXYucGlsYS52bi9hcGkvdjEvc2NoZW1hcy9kYzdhZDA1ZC02MGQ5LTQyN2QtYTEyNS1hOGUwOWNlOWJiMWUiLCJ0eXBlIjoiSnNvblNjaGVtYSJ9LCJjcmVkZW50aWFsU3ViamVjdCI6eyJjYXBzdWxlIjoiMjAwMDAwMDA3YjE2NzFlMWViNTU3NWQwZTc3YmMyMmMxNDE1YjVmOTVjNTgyMTE5NzAwMzc2ZWQ4Mzg1MGU0MjJlYTdhNDg1MjAwMDAwMDA5M2RhNjI1MzFkN2Y2OWIzMDgzYmVhYzZhNmNjYWE2NGJmYTViYWZlYThmNzg0YWJkZjgzYTViNDc4NGUwODhjMjAwMDAwMDA0NWVhYzhmOTZkMjE5ZTYxNjEzMDdlODAwMWM5Mzk2MDU0Y2E1NDFiZWRlZWI1ZjBhYmM2NDM0MzljZmI2ZTRkMjAwMDAwMDAxNGI0MjcyZGE4MGFlNzZiZTcwNTRkNTFlNzQzNTgxYzZjMzA0MTI5N2NjZTJjMzZiOTJjMmRmZmIxODFhNzhiMjAwMDAwMDBmMjVlOGJiZjdmZmZlYjJjNmMwNWVhOThmNzBjODE0NTA4MWE2ODM5NmE2MWU3M2QzMjc0YTEzZGFjZDQ5ZTc2MDAwMDEwMDAwMDA0ODdjYmI2MDc3MDA4Yjg1NmE0YTUzOWEwNWQyNTE5YzRkYjAxYzY5YTk5YzA0ODU3ODNjMWE5NzVhN2YxZTJiM2FkMWE0YzMxZmMwNDJlYmY3Yjc4MDRlMDkzYzg5NTNhY2RhNDE4Yjk4MjgxN2ViYzhhYWJmYTEwYWJjYWFkMTIiLCJjaWQiOiJiYWZrcmVpYXU0bnVjczRhcHQ3cHlqNGx4cnNuZWxjc3VvczZ0Mzd6d2M3eWpwYnQ1aG9jZ3lzZ3JieSIsImlkIjoiZGlkOm5kYTp0ZXN0bmV0OjB4MmFmN2U4ZWJmZWMxNGY1ZTM5NDY5ZDJjZTg0NDJhNWVlZjlmM2ZhNCIsInBlcm1pc3Npb25zIjpbInJlYWQiXSwicm9sZSI6InZpZXdlciJ9LCJpZCI6ImRpZDpuZGE6dGVzdG5ldDplMTM2ODdmYS02ZDQ4LTQyYTQtOGRmOC00NWI5NjEwYWNiZjgiLCJpc3N1ZXIiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgxNmM1MTMwZGVmNjQ5NmY1ZGU5M2Y5MDc2YTVjZWIwNWNlNTllNGIwIiwidHlwZSI6IlZlcmlmaWFibGVDcmVkZW50aWFsIiwidmFsaWRGcm9tIjoiMjAyNS0xMS0xOFQxMTo0MjoyOFoiLCJ2YWxpZFVudGlsIjoiMTk3MC0wMS0wMVQwMDowMDowMFoifX0.0xi5QicwhcOVp35qh92TUka3JvVFgA8-84UWe5ccdDcruvbX13Q0pwLxs6wN4t4gM628YVifwnjEWpLM44lBVA",
	}
	token, err := a.CreateToken(context.Background(), vcJwts, "did:nda:testnet:0x2af7e8ebfec14f5e39469d2ce8442a5eef9f3fa4", "0x2af7e8ebfec14f5e39469d2ce8442a5eef9f3fa4")
	if err != nil {
		fmt.Println(err)
		t.Fatalf("expected non-nil error")
	}
	if token == "" {
		t.Fatalf("expected non-nil token")
	}
	fmt.Println(token)
}

// TestVerifyToken ensures VerifyToken returns a non-nil claims.
func TestVerifyToken(t *testing.T) {
	provider := provider.NewVaultProvider("", "", 3)
	a := auth.NewAuth(provider, "https://auth-dev.pila.vn/api/v1/did")
	claims, err := a.VerifyToken(context.Background(), "eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgyYWY3ZThlYmZlYzE0ZjVlMzk0NjlkMmNlODQ0MmE1ZWVmOWYzZmE0I2tleS0xIiwidHlwIjoiSldUIn0.eyJpc3MiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgyYWY3ZThlYmZlYzE0ZjVlMzk0NjlkMmNlODQ0MmE1ZWVmOWYzZmE0Iiwic3ViIjoiZGlkOm5kYTp0ZXN0bmV0OjB4MmFmN2U4ZWJmZWMxNGY1ZTM5NDY5ZDJjZTg0NDJhNWVlZjlmM2ZhNCIsInZwIjp7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy92MiIsImh0dHBzOi8vd3d3LnczLm9yZy9ucy9jcmVkZW50aWFscy9leGFtcGxlcy92MiJdLCJob2xkZXIiOiJkaWQ6bmRhOnRlc3RuZXQ6MHgyYWY3ZThlYmZlYzE0ZjVlMzk0NjlkMmNlODQ0MmE1ZWVmOWYzZmE0IiwidHlwZSI6IlZlcmlmaWFibGVQcmVzZW50YXRpb24iLCJ2ZXJpZmlhYmxlQ3JlZGVudGlhbCI6WyJleUpoYkdjaU9pSkZVekkxTmtzaUxDSnJhV1FpT2lKa2FXUTZibVJoT25SbGMzUnVaWFE2TUhneE5tTTFNVE13WkdWbU5qUTVObVkxWkdVNU0yWTVNRGMyWVRWalpXSXdOV05sTlRsbE5HSXdJMnRsZVMweElpd2lkSGx3SWpvaVNsZFVJbjAuZXlKbGVIQWlPakFzSW1saGRDSTZNVGMyTXpRMk5ETTFPU3dpYVhOeklqb2laR2xrT201a1lUcDBaWE4wYm1WME9qQjRNVFpqTlRFek1HUmxaalkwT1RabU5XUmxPVE5tT1RBM05tRTFZMlZpTURWalpUVTVaVFJpTUNJc0ltcDBhU0k2SW1ScFpEcHVaR0U2ZEdWemRHNWxkRHBoT0dGbU1ETmlOaTFoTlRJd0xUUmpOamd0T0RsaU9DMDVaV1ZsTVRCbVl6TXhOaklpTENKdVltWWlPakUzTmpNME5qUXpOVGtzSW5OMVlpSTZJbVJwWkRwdVpHRTZkR1Z6ZEc1bGREb3dlREpoWmpkbE9HVmlabVZqTVRSbU5XVXpPVFEyT1dReVkyVTRORFF5WVRWbFpXWTVaak5tWVRRaUxDSjJZeUk2ZXlKQVkyOXVkR1Y0ZENJNld5Sm9kSFJ3Y3pvdkwzZDNkeTUzTXk1dmNtY3Zibk12WTNKbFpHVnVkR2xoYkhNdmRqSWlMQ0pvZEhSd2N6b3ZMM2QzZHk1M015NXZjbWN2Ym5NdlkzSmxaR1Z1ZEdsaGJITXZaWGhoYlhCc1pYTXZkaklpWFN3aVkzSmxaR1Z1ZEdsaGJGTmphR1Z0WVNJNmV5SnBaQ0k2SW1oMGRIQnpPaTh2WVhWMGFDMWtaWFl1Y0dsc1lTNTJiaTloY0drdmRqRXZjMk5vWlcxaGN5OWtZemRoWkRBMVpDMDJNR1E1TFRReU4yUXRZVEV5TlMxaE9HVXdPV05sT1dKaU1XVWlMQ0owZVhCbElqb2lTbk52YmxOamFHVnRZU0o5TENKamNtVmtaVzUwYVdGc1UzVmlhbVZqZENJNmV5SmpZWEJ6ZFd4bElqb2lNakF3TURBd01EQXhORFkyTW1Zd05USXhZelUzTUdNeU1HUTVOV1E0WkRjMFlqQmxNbVkzWVRrd05qTXhOemMxTXpBeVlURTJPVEpqTlRrNVlXRTJOakkwWlRBNU5URXhNakF3TURBd01EQmlaVGN6WVRSbVl6QTNOelprWVdJNE5UUmhOVGt5WVRSalltRmxPVFZrT0dNMVlUVm1OakF5WWpjeFpqVTFPREJsTkRWbU56UTRNbVJsT1dFME9EYzVNakF3TURBd01EQmpNalJoWmpnek1tRTBOamsyTnpoa016RmhPREptTUdNd1l6TTVaR0UwTkdOaU1qUmpPV015T0RWbFl6Y3hNMk0wT0RJd1l6RTBaRGMwTkRRME5EUTRNakF3TURBd01EQXpZVFEwTkdSaU9HUTJNMlk0Wm1Jek56QmpNRGRsT0RrNU5tVmxZamRtTXpSa01qVTNabVprT0dFd05EWTNNamM0TVRRelpqazBOak14WWpjd09HUm1NakF3TURBd01EQm1NalZsT0dKaVpqZG1abVpsWWpKak5tTXdOV1ZoT1RobU56QmpPREUwTlRBNE1XRTJPRE01Tm1FMk1XVTNNMlF6TWpjMFlURXpaR0ZqWkRRNVpUYzJNREF3TURFd01EQXdNREEwTWpsalpHTmtOREV4Tmpsa05UQmhaV001WWpFNU0yUmpOREUzTmpJME1qRTRaakprWldRMU4yTTBaVGhrTVdGaE1ETXpaR0ZqTW1NNU1tTmtNamN6TWpJNU9UaGpNbVJrT1dWaE1qWTBNRFUwTVRWbE1qazFZamRqTVRrMk1EQXlOekkyTkdNME4ySm1OemszTTJVME9UTTRPVGxtWVRZMU1Ea3pZV05sWm1ZaUxDSmphV1FpT2lKaVlXWnJjbVZwWVhVMGJuVmpjelJoY0hRM2NIbHFOR3g0Y25OdVpXeGpjM1Z2Y3paME16ZDZkMk0zZVdwd1luUTFhRzlqWjNselozSmllU0lzSW1sa0lqb2laR2xrT201a1lUcDBaWE4wYm1WME9qQjRNbUZtTjJVNFpXSm1aV014TkdZMVpUTTVORFk1WkRKalpUZzBOREpoTldWbFpqbG1NMlpoTkNJc0luQmxjbTFwYzNOcGIyNXpJanBiSW5KbFlXUWlYU3dpY205c1pTSTZJblpwWlhkbGNpSjlMQ0pwWkNJNkltUnBaRHB1WkdFNmRHVnpkRzVsZERwaE9HRm1NRE5pTmkxaE5USXdMVFJqTmpndE9EbGlPQzA1WldWbE1UQm1Zek14TmpJaUxDSnBjM04xWlhJaU9pSmthV1E2Ym1SaE9uUmxjM1J1WlhRNk1IZ3hObU0xTVRNd1pHVm1OalE1Tm1ZMVpHVTVNMlk1TURjMllUVmpaV0l3TldObE5UbGxOR0l3SWl3aWRIbHdaU0k2SWxabGNtbG1hV0ZpYkdWRGNtVmtaVzUwYVdGc0lpd2lkbUZzYVdSR2NtOXRJam9pTWpBeU5TMHhNUzB4T0ZReE1Ub3hNam96T1ZvaUxDSjJZV3hwWkZWdWRHbHNJam9pTVRrM01DMHdNUzB3TVZRd01Eb3dNRG93TUZvaWZYMC54VjR2Q3ZpanFZc0FWR2pmM0RpWDdxakdzQVBhMHMyWWQ5cmdCQjY3X0dORGZ4QW1GTVVWTFUwX1gxdGVoWmZDemQzWTRFWHppZkk4NTBjNFJEMjRLUSIsImV5SmhiR2NpT2lKRlV6STFOa3NpTENKcmFXUWlPaUprYVdRNmJtUmhPblJsYzNSdVpYUTZNSGd4Tm1NMU1UTXdaR1ZtTmpRNU5tWTFaR1U1TTJZNU1EYzJZVFZqWldJd05XTmxOVGxsTkdJd0kydGxlUzB4SWl3aWRIbHdJam9pU2xkVUluMC5leUpsZUhBaU9qQXNJbWxoZENJNk1UYzJNelEyTmpFME9Dd2lhWE56SWpvaVpHbGtPbTVrWVRwMFpYTjBibVYwT2pCNE1UWmpOVEV6TUdSbFpqWTBPVFptTldSbE9UTm1PVEEzTm1FMVkyVmlNRFZqWlRVNVpUUmlNQ0lzSW1wMGFTSTZJbVJwWkRwdVpHRTZkR1Z6ZEc1bGREcGxNVE0yT0RkbVlTMDJaRFE0TFRReVlUUXRPR1JtT0MwME5XSTVOakV3WVdOaVpqZ2lMQ0p1WW1ZaU9qRTNOak0wTmpZeE5EZ3NJbk4xWWlJNkltUnBaRHB1WkdFNmRHVnpkRzVsZERvd2VESmhaamRsT0dWaVptVmpNVFJtTldVek9UUTJPV1F5WTJVNE5EUXlZVFZsWldZNVpqTm1ZVFFpTENKMll5STZleUpBWTI5dWRHVjRkQ0k2V3lKb2RIUndjem92TDNkM2R5NTNNeTV2Y21jdmJuTXZZM0psWkdWdWRHbGhiSE12ZGpJaUxDSm9kSFJ3Y3pvdkwzZDNkeTUzTXk1dmNtY3Zibk12WTNKbFpHVnVkR2xoYkhNdlpYaGhiWEJzWlhNdmRqSWlYU3dpWTNKbFpHVnVkR2xoYkZOamFHVnRZU0k2ZXlKcFpDSTZJbWgwZEhCek9pOHZZWFYwYUMxa1pYWXVjR2xzWVM1MmJpOWhjR2t2ZGpFdmMyTm9aVzFoY3k5a1l6ZGhaREExWkMwMk1HUTVMVFF5TjJRdFlURXlOUzFoT0dVd09XTmxPV0ppTVdVaUxDSjBlWEJsSWpvaVNuTnZibE5qYUdWdFlTSjlMQ0pqY21Wa1pXNTBhV0ZzVTNWaWFtVmpkQ0k2ZXlKallYQnpkV3hsSWpvaU1qQXdNREF3TURBM1lqRTJOekZsTVdWaU5UVTNOV1F3WlRjM1ltTXlNbU14TkRFMVlqVm1PVFZqTlRneU1URTVOekF3TXpjMlpXUTRNemcxTUdVME1qSmxZVGRoTkRnMU1qQXdNREF3TURBNU0yUmhOakkxTXpGa04yWTJPV0l6TURnelltVmhZelpoTm1OallXRTJOR0ptWVRWaVlXWmxZVGhtTnpnMFlXSmtaamd6WVRWaU5EYzROR1V3T0Roak1qQXdNREF3TURBME5XVmhZemhtT1Raa01qRTVaVFl4TmpFek1EZGxPREF3TVdNNU16azJNRFUwWTJFMU5ERmlaV1JsWldJMVpqQmhZbU0yTkRNME16bGpabUkyWlRSa01qQXdNREF3TURBeE5HSTBNamN5WkdFNE1HRmxOelppWlRjd05UUmtOVEZsTnpRek5UZ3hZelpqTXpBME1USTVOMk5qWlRKak16WmlPVEpqTW1SbVptSXhPREZoTnpoaU1qQXdNREF3TURCbU1qVmxPR0ppWmpkbVptWmxZakpqTm1Nd05XVmhPVGhtTnpCak9ERTBOVEE0TVdFMk9ETTVObUUyTVdVM00yUXpNamMwWVRFelpHRmpaRFE1WlRjMk1EQXdNREV3TURBd01EQTBPRGRqWW1JMk1EYzNNREE0WWpnMU5tRTBZVFV6T1dFd05XUXlOVEU1WXpSa1lqQXhZelk1WVRrNVl6QTBPRFUzT0ROak1XRTVOelZoTjJZeFpUSmlNMkZrTVdFMFl6TXhabU13TkRKbFltWTNZamM0TURSbE1Ea3pZemc1TlROaFkyUmhOREU0WWprNE1qZ3hOMlZpWXpoaFlXSm1ZVEV3WVdKallXRmtNVElpTENKamFXUWlPaUppWVdacmNtVnBZWFUwYm5WamN6UmhjSFEzY0hscU5HeDRjbk51Wld4amMzVnZjelowTXpkNmQyTTNlV3B3WW5RMWFHOWpaM2x6WjNKaWVTSXNJbWxrSWpvaVpHbGtPbTVrWVRwMFpYTjBibVYwT2pCNE1tRm1OMlU0WldKbVpXTXhOR1kxWlRNNU5EWTVaREpqWlRnME5ESmhOV1ZsWmpsbU0yWmhOQ0lzSW5CbGNtMXBjM05wYjI1eklqcGJJbkpsWVdRaVhTd2ljbTlzWlNJNkluWnBaWGRsY2lKOUxDSnBaQ0k2SW1ScFpEcHVaR0U2ZEdWemRHNWxkRHBsTVRNMk9EZG1ZUzAyWkRRNExUUXlZVFF0T0dSbU9DMDBOV0k1TmpFd1lXTmlaamdpTENKcGMzTjFaWElpT2lKa2FXUTZibVJoT25SbGMzUnVaWFE2TUhneE5tTTFNVE13WkdWbU5qUTVObVkxWkdVNU0yWTVNRGMyWVRWalpXSXdOV05sTlRsbE5HSXdJaXdpZEhsd1pTSTZJbFpsY21sbWFXRmliR1ZEY21Wa1pXNTBhV0ZzSWl3aWRtRnNhV1JHY205dElqb2lNakF5TlMweE1TMHhPRlF4TVRvME1qb3lPRm9pTENKMllXeHBaRlZ1ZEdsc0lqb2lNVGszTUMwd01TMHdNVlF3TURvd01Eb3dNRm9pZlgwLjB4aTVRaWN3aGNPVnAzNXFoOTJUVWthM0p2VkZnQTgtODRVV2U1Y2NkRGNydXZiWDEzUTBwd0x4czZ3TjR0NGdNNjI4WVZpZnduakVXcExNNDRsQlZBIl19fQ.-GtX3hmhdqyGfBQDNV5D8CR_WpjNXcA8qFpJafEPT198nT-z6sWyuj12EGq4tynvuYzLQKIQakNfgxTPM1SBKQ")
	if err != nil {
		fmt.Println(err)
		t.Fatalf("expected non-nil error")
	}

	claimsBytes, err := json.Marshal(claims)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("expected non-nil error")
	}
	fmt.Println(string(claimsBytes))
}
